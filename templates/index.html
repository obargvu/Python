<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YohkEcar</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; background: linear-gradient(120deg, #e0c3fc 0%, #8ec5fc 100%); margin: 0; color: #2d3436; min-height: 100vh; }
        header { background: white; padding: 15px 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; position: sticky; top: 0; z-index: 100; }
        .logo-link { text-decoration: none; }
        h1 { font-family: 'Montserrat', sans-serif; font-weight: 800; font-size: 2.5em; margin: 0; background: linear-gradient(to right, #0984e3, #00cec9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-transform: uppercase; letter-spacing: -1px; }
        .btn-group { margin-top: 15px; }
        .btn { padding: 10px 25px; border-radius: 50px; text-decoration: none; font-weight: 700; margin: 0 5px; transition: all 0.3s ease; display: inline-block; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: none; font-size: 14px; cursor: pointer;}
        .btn-create { background: linear-gradient(45deg, #0984e3, #74b9ff); color: white; }
        .btn-logout { background: white; color: #ff7675; border: 2px solid #ff7675; }
        .btn-login { background: white; color: #0984e3; border: 2px solid #0984e3; }
        .btn-admin { background: #2d3436; color: #fab1a0; border: 2px solid #2d3436; }
        .btn-support { background: #6c5ce7; color: white; }
        .btn-fav { background: white; color: #e84393; border: 2px solid #e84393; }

        .search-bar { background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(10px); padding: 10px 20px; margin-top: 20px; border-radius: 50px; display: flex; gap: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); flex-wrap: wrap; justify-content: center; }
        .search-input, .search-select { padding: 12px 20px; border-radius: 50px; border: 1px solid #dfe6e9; outline: none; font-family: inherit; }
        .search-btn { padding: 12px 25px; border-radius: 50px; border: none; background: #0984e3; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }

        h2 { text-align: center; color: #2d3436; margin-top: 40px; font-weight: 800; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; display: grid; gap: 20px; }

        .item-card { background: white; padding: 20px; border-radius: 20px; display: flex; gap: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); transition: transform 0.3s, box-shadow 0.3s; align-items: center; border: 1px solid rgba(255,255,255,0.5); position: relative; overflow: hidden;}
        .item-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }

        .vip-card { border: 3px solid #ffd700; background: linear-gradient(to right, #fff, #fff9e6); }
        .vip-badge { background: #ffd700; color: #b33e00; font-weight: bold; padding: 5px 10px; border-radius: 10px; font-size: 0.8em; display: inline-block; margin-bottom: 5px; }

        .ad-banner { background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%); border-radius: 20px; padding: 30px; text-align: center; color: #fff; font-weight: bold; font-size: 1.2em; box-shadow: 0 10px 20px rgba(255, 154, 158, 0.4); border: 2px dashed white; margin: 10px 0; cursor: pointer; transition: 0.3s; }
        .ad-banner:hover { transform: scale(1.02); }
        .ad-label { background: rgba(0,0,0,0.2); padding: 2px 8px; border-radius: 5px; font-size: 0.7em; margin-bottom: 10px; display: inline-block;}
        .btn-buy-vip { background: white; color: #ff9a9e; border: none; padding: 10px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 15px; display: inline-block; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-buy-vip:hover { background: #ffeaea; transform: translateY(-2px); }

        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; border-radius: 20px; width: 90%; max-width: 500px; text-align: center; position: relative; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; font-weight: bold; color: #b2bec3; cursor: pointer; transition: 0.3s; }
        .close-btn:hover { color: #ff7675; }
        .vip-price-list { list-style: none; padding: 0; margin: 20px 0; }
        .vip-price-list li { background: #f1f2f6; margin: 10px 0; padding: 15px; border-radius: 10px; font-size: 1.1em; font-weight: bold; color: #2d3436; }

        .gallery-box { width: 160px; flex-shrink: 0; }
        .main-image { width: 160px; height: 160px; object-fit: cover; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .thumbnails { display: flex; gap: 5px; margin-top: 8px; justify-content: center; }
        .thumb { width: 30px; height: 30px; object-fit: cover; border-radius: 5px; opacity: 0.6; }

        .item-info { flex: 1; text-align: left; }
        .item-title { text-decoration: none; color: #2d3436; font-size: 1.5em; font-weight: 800; display: block; margin-bottom: 5px; }
        .price { color: #0984e3; font-weight: 800; font-size: 1.4em; background: #e1f5fe; padding: 5px 15px; border-radius: 10px; display: inline-block; margin: 5px 0; }
        .category-tag { background: #dfe6e9; padding: 4px 12px; border-radius: 50px; font-size: 0.8em; color: #636e72; font-weight: 700;}
        .location-tag { color: #636e72; font-size: 0.9em; margin-left: 10px; font-weight: bold;}

        .fav-heart { float: right; font-size: 1.5em; text-decoration: none; transition: 0.2s; }
        .fav-heart:hover { transform: scale(1.2); }

        .delete-btn { color: #ff7675; text-decoration: none; font-size: 0.9em; border: 1px solid #ff7675; padding: 5px 15px; border-radius: 50px; float: right; margin-left: 10px;}
        .delete-btn:hover { background: #ff7675; color: white; }

        .pagination { margin: 40px 0; text-align: center; }
        .page-btn { background: white; color: #0984e3; padding: 10px 25px; text-decoration: none; border-radius: 50px; margin: 0 5px; font-weight: bold; }

        @media (max-width: 600px) {
            .item-card { flex-direction: column; text-align: center; }
            .item-info { text-align: center; }
            .delete-btn { float: none; display: inline-block; margin-top: 10px; }
            .fav-heart { float: none; display: block; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <header>
        <a href="/" class="logo-link"><h1>üöô YohkEcar</h1></a>
        <div class="search-bar">
            <form action="/" method="get" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
                <input type="text" name="q" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ (–¢–æ–≤–∞—Ä –∏–ª–∏ –ì–æ—Ä–æ–¥)" value="{{ search_query }}">

                <select name="cat" class="search-select">
                    <option value="–í—Å–µ">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <option value="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç">üöó –ê–≤—Ç–æ</option>
                    <option value="–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å">üè† –î–æ–º</option>
                    <option value="–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞">üì± –ì–∞–¥–∂–µ—Ç—ã</option>
                    <option value="–û–¥–µ–∂–¥–∞">üëï –û–¥–µ–∂–¥–∞</option>
                    <option value="–£—Å–ª—É–≥–∏">üõ† –£—Å–ª—É–≥–∏</option>
                    <option value="–ñ–∏–≤–æ—Ç–Ω—ã–µ">üêà –ñ–∏–≤–æ—Ç–Ω—ã–µ</option>
                    <option value="–î—Ä—É–≥–æ–µ">üì¶ –î—Ä—É–≥–æ–µ</option>
                </select>

                <select name="country" class="search-select">
                    <option value="">üá™üá∫ –í—Å—è –ï–≤—Ä–æ–ø–∞</option>
                    <option value="–ê–≤—Å—Ç—Ä–∏—è">üá¶üáπ –ê–≤—Å—Ç—Ä–∏—è</option>
                    <option value="–ë–µ–ª—å–≥–∏—è">üáßüá™ –ë–µ–ª—å–≥–∏—è</option>
                    <option value="–ë–æ–ª–≥–∞—Ä–∏—è">üáßüá¨ –ë–æ–ª–≥–∞—Ä–∏—è</option>
                    <option value="–í–µ–Ω–≥—Ä–∏—è">üá≠üá∫ –í–µ–Ω–≥—Ä–∏—è</option>
                    <option value="–ì–µ—Ä–º–∞–Ω–∏—è">üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è</option>
                    <option value="–ì—Ä–µ—Ü–∏—è">üá¨üá∑ –ì—Ä–µ—Ü–∏—è</option>
                    <option value="–ò—Å–ø–∞–Ω–∏—è">üá™üá∏ –ò—Å–ø–∞–Ω–∏—è</option>
                    <option value="–ò—Ç–∞–ª–∏—è">üáÆüáπ –ò—Ç–∞–ª–∏—è</option>
                    <option value="–ö–∏–ø—Ä">üá®üáæ –ö–∏–ø—Ä</option>
                    <option value="–õ–∞—Ç–≤–∏—è">üá±üáª –õ–∞—Ç–≤–∏—è</option>
                    <option value="–õ–∏—Ç–≤–∞">üá±üáπ –õ–∏—Ç–≤–∞</option>
                    <option value="–õ—é–∫—Å–µ–º–±—É—Ä–≥">üá±üá∫ –õ—é–∫—Å–µ–º–±—É—Ä–≥</option>
                    <option value="–ú–∞–ª—å—Ç–∞">üá≤üáπ –ú–∞–ª—å—Ç–∞</option>
                    <option value="–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã">üá≥üá± –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã</option>
                    <option value="–ü–æ–ª—å—à–∞">üáµüá± –ü–æ–ª—å—à–∞</option>
                    <option value="–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è">üáµüáπ –ü–æ—Ä—Ç—É–≥–∞–ª–∏—è</option>
                    <option value="–†—É–º—ã–Ω–∏—è">üá∑üá¥ –†—É–º—ã–Ω–∏—è</option>
                    <option value="–°–ª–æ–≤–∞–∫–∏—è">üá∏üá∞ –°–ª–æ–≤–∞–∫–∏—è</option>
                    <option value="–°–ª–æ–≤–µ–Ω–∏—è">üá∏üáÆ –°–ª–æ–≤–µ–Ω–∏—è</option>
                    <option value="–§–∏–Ω–ª—è–Ω–¥–∏—è">üá´üáÆ –§–∏–Ω–ª—è–Ω–¥–∏—è</option>
                    <option value="–§—Ä–∞–Ω—Ü–∏—è">üá´üá∑ –§—Ä–∞–Ω—Ü–∏—è</option>
                    <option value="–ß–µ—Ö–∏—è">üá®üáø –ß–µ—Ö–∏—è</option>
                    <option value="–®–≤–µ—Ü–∏—è">üá∏üá™ –®–≤–µ—Ü–∏—è</option>
                    <option value="–≠—Å—Ç–æ–Ω–∏—è">üá™üá™ –≠—Å—Ç–æ–Ω–∏—è</option>
                </select>

                <button type="submit" class="search-btn">–ù–∞–π—Ç–∏</button>
            </form>
        </div>
        <div class="btn-group">
            {% if user_login %}
                <h3>–ü—Ä–∏–≤–µ—Ç, {{ user_name }}! üëã</h3>
                <a href="/favorites" class="btn btn-fav">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>

                {% if session.get('is_admin') == 1 or session.get('is_moderator') == 1 %} 
                    <a href="/admin" class="btn btn-admin">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</a>
                {% endif %}

                {% if session.get('is_admin') == 1 or session.get('can_chat') == 1 %}
                    <a href="/admin/chats" class="btn btn-admin">üí¨ –í—Ö–æ–¥—è—â–∏–µ</a>
                {% endif %}

                {% if session.get('is_admin') != 1 and session.get('can_chat') != 1 %}
                    <a href="/support" class="btn btn-support">üéß –ù–∞–ø–∏—Å–∞—Ç—å –∞–¥–º–∏–Ω—É</a>
                {% endif %}

                <a href="/my_ads" class="btn btn-login" style="background: #fab1a0; color: white; border: none;">üì¶ –ú–æ–∏</a>
                <a href="/create" class="btn btn-create">+ –û–±—ä—è–≤–ª–µ–Ω–∏–µ</a>
                <a href="/logout" class="btn btn-logout">–í—ã–π—Ç–∏</a>
            {% else %}
                <a href="/login" class="btn btn-login">–í–æ–π—Ç–∏</a>
                <a href="/register" class="btn btn-create">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            {% endif %}
        </div>
    </header>

    <h2>‚ú® –°–≤–µ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>

    <div class="container">
        <div class="ad-banner">
            <div class="ad-label">–†–ï–ö–õ–ê–ú–ê</div>
            üöÄ –•–æ—á–µ—à—å –ø—Ä–æ–¥–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ? –¢–æ–≥–¥–∞ –∑–∞–∫—Ä–µ–ø–∏ —Å–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!
            <br>
            <button class="btn-buy-vip" onclick="openVipModal()">–ö—É–ø–∏—Ç—å VIP —Å—Ç–∞—Ç—É—Å</button>
        </div>

        {% for item in items %}

            {% if loop.index == 4 %}
                <div class="ad-banner" style="background: linear-gradient(45deg, #a18cd1 0%, #fbc2eb 100%); box-shadow: 0 10px 20px rgba(161, 140, 209, 0.4);">
                    <div class="ad-label">–†–ï–ö–õ–ê–ú–ê</div>
                    üì¢ –ó–¥–µ—Å—å –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞!<br>
                    –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è.
                </div>
            {% endif %}

            <div class="item-card {% if item['vip_expiry'] > time.time() %}vip-card{% endif %}">
                <div class="gallery-box">
                    <img src="{{ item['image1'] }}" class="main-image">
                    <div class="thumbnails">
                        {% if item['image2'] %}<img src="{{ item['image2'] }}" class="thumb">{% endif %}
                        {% if item['image3'] %}<img src="{{ item['image3'] }}" class="thumb">{% endif %}
                    </div>
                </div>

                <div class="item-info">

                    {% if user_login %}
                        <a href="/fav/{{ item['id'] }}" class="fav-heart">
                            {% if item['id'] in liked_ids %}
                                ‚ù§Ô∏è
                            {% else %}
                                ü§ç
                            {% endif %}
                        </a>
                    {% endif %}

                    {% if user_login == item['owner_login'] or session.get('is_admin') == 1 or session.get('can_ban') == 1 %}
                        <a href="/delete/{{ item['id'] }}" class="delete-btn">üóë –£–¥–∞–ª–∏—Ç—å</a>
                    {% endif %}

                    {% if item['vip_expiry'] > time.time() %}
                        <div class="vip-badge">üëë VIP –û–±—ä—è–≤–ª–µ–Ω–∏–µ</div>
                    {% endif %}

                    <a href="/item/{{ item['id'] }}" class="item-title">{{ item['title'] }}</a>

                    <span class="category-tag">{{ item['category'] }}</span> 
                    <span class="location-tag">üìç {{ item['city'] }} ({{ item['region'] }})</span>
                    <br>
                    <span class="price">{{ item['price'] }} ‚Ç¨</span> 

                    <p class="description">{{ item['description'][:100] }}...</p> 

                    <div class="seller-info">
                        <span>üë§ {{ item['owner_name'] }}</span>
                        <span style="margin-left: 10px; color: gray;">üëÅÔ∏è {{ item['views'] }}</span>
                    </div>
                </div>
            </div>
        {% else %}
            <div style="background: white; padding: 40px; border-radius: 20px; text-align: center;">
                <h3>–ü—É—Å—Ç–æ... ü¶ó</h3>
                <p>–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
                <a href="/" style="color: #0984e3; font-weight: bold;">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
            </div>
        {% endfor %}

        {% if total_pages > 1 %}
            <div class="pagination">
                {% if page > 1 %}
                    <a href="/?page={{ page - 1 }}" class="page-btn">‚Üê –ù–∞–∑–∞–¥</a>
                {% endif %}
                <span class="current-page">–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page }}</span>
                {% if page < total_pages %}
                    <a href="/?page={{ page + 1 }}" class="page-btn">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
                {% endif %}
            </div>
        {% endif %}
    </div>

    <div id="vipModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-btn" onclick="closeVipModal()">&times;</span>
            <h2 style="color: #0984e3; margin-top: 10px;">üëë VIP –°—Ç–∞—Ç—É—Å</h2>
            <p>–ó–∞–∫—Ä–µ–ø–∏—Ç–µ –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö—É —Å–ø–∏—Å–∫–∞ –∏ –≤—ã–¥–µ–ª–∏—Ç–µ –µ–≥–æ –∑–æ–ª–æ—Ç–æ–π —Ä–∞–º–∫–æ–π!</p>

            <ul class="vip-price-list">
                <li>1 –¥–µ–Ω—å ‚Äî 1‚Ç¨</li>
                <li>7 –¥–Ω–µ–π ‚Äî 4,99‚Ç¨</li>
                <li>30 –¥–Ω–µ–π (–ú–µ—Å—è—Ü) ‚Äî 15‚Ç¨</li>
            </ul>

            <p style="margin-top: 20px; font-weight: bold; color: #636e72;">
                ‚ÑπÔ∏è –î–ª—è –ø–æ–∫—É–ø–∫–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –≤ —á–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
            </p>

            {% if user_login %}
                <a href="/support" class="btn btn-support" style="margin-top: 10px; display: inline-block; width: auto;">üéß –ù–∞–ø–∏—Å–∞—Ç—å –ê–¥–º–∏–Ω—É</a>
            {% else %}
                <p><i><a href="/login" style="color:#0984e3;">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –∞–¥–º–∏–Ω—É.</i></p>
            {% endif %}
        </div>
    </div>

    <footer style="background: white; padding: 30px; margin-top: 50px; text-align: center; border-top: 1px solid #dfe6e9;">
        <div style="max-width: 800px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">
            <a href="/policy" style="color: #636e72; text-decoration: none;">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
            <a href="/terms" style="color: #636e72; text-decoration: none;">–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
        </div>
        <p style="color: #b2bec3; font-size: 0.8em; margin-top: 20px;">
            ¬© 2025 YohkEcar Europe. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.<br>
            –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –¥–ª—è –ï–° üá™üá∫
        </p>
    </footer>

    <script>
        function openVipModal() { document.getElementById('vipModal').style.display = 'flex'; }
        function closeVipModal() { document.getElementById('vipModal').style.display = 'none'; }
        window.onclick = function(event) {
            var modal = document.getElementById('vipModal');
            if (event.target == modal) { modal.style.display = "none"; }
        }
    </script>

    </body>
    </html>